# charts/tradestream/values.yaml
kafka:
  replicaCount: 3
  image:
    repository: confluentinc/cp-kafka
    tag: 7.0.0  # Version compatible with Kafka 3.x for KRaft mode

  config:
    # KRaft-specific configuration
    processRoles: broker,controller
    # The node ID will be set dynamically in the StatefulSet
    controllerQuorumVoters: |
      0@kafka-0.kafka-headless.tradestream-namespace.svc.cluster.local:9093,\
      1@kafka-1.kafka-headless.tradestream-namespace.svc.cluster.local:9093,\
      2@kafka-2.kafka-headless.tradestream-namespace.svc.cluster.local:9093
    listeners: PLAINTEXT://0.0.0.0:9092,CONTROLLER://0.0.0.0:9093
    listenerSecurityProtocolMap: CONTROLLER:PLAINTEXT,PLAINTEXT:PLAINTEXT
    interBrokerListenerName: PLAINTEXT
    controllerListenerNames: CONTROLLER
    logDirs: /var/lib/kafka/data
    offsetStorage: kafka
    transactionStateLogReplicationFactor: 3
    transactionStateLogMinIsr: 2

  resources:
    requests:
      memory: 2048Mi
      cpu: 1000m
