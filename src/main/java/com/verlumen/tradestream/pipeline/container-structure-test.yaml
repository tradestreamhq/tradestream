# See https://github.com/GoogleContainerTools/container-structure-test#command-tests
schemaVersion: 2.0.0
commandTests:
  - name: "Dry pipeline run"
    command: java
    args:
      - '-Dio.jenetics.util.defaultRandomGenerator=Random'
      - '-jar'
      - '/src/main/java/com/verlumen/tradestream/pipeline/app_deploy.jar'
      - '--maxForwardIntervals=1'
      - '--runMode=dry'
      - '--coinMarketCapApiKey=fakeKey'
      - '--tiingoApiKey=fakeKey'
      - '--influxDbToken=test_token_for_dry_run'
      - '--influxDbOrg=test_org_for_dry_run'
      - '--influxDbUrl=http://fake-influxdb-for-dry-run:8086'
      - '--influxDbBucket=test_bucket_for_dry_run'
    expectedError:
      - "DRY/RUN"
      - 'Starting TradeToCandle transform \(Combine\.perKey version\) with window duration: PT60S'
