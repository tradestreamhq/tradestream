common --enable_bzlmod

# Add Java toolchain platform configuration
build --java_runtime_version=remotejdk_17
build --java_language_version=17
build --tool_java_runtime_version=remotejdk_17
build --tool_java_language_version=17

build --verbose_failures
build --sandbox_debug

test --experimental_ui_max_stdouterr_bytes=2097152
test --test_output=all
test --verbose_failures

# Build Buddy configuration
build --bes_results_url=https://app.buildbuddy.io/invocation/
build --bes_backend=grpcs://remote.buildbuddy.io
build --remote_cache=grpcs://remote.buildbuddy.io
build --remote_timeout=10m
build --experimental_remote_cache_compression
build --nolegacy_important_outputs
build --noremote_upload_local_results # Uploads logs & artifacts without writing to cache
build --experimental_remote_cache_compression_threshold=100
build --noslim_profile
build --experimental_profile_include_target_label
build --experimental_profile_include_primary_output 
# Fix for absolute path inclusions in protobuf
build --sandbox_add_mount_pair=/usr/lib/gcc

# Additional helpful settings
build --incompatible_enable_cc_toolchain_resolution=false
build --action_env=CC=gcc
build --action_env=CXX=g++
